<!DOCTYPE html>
<html>
<head>
    <title>WSJFBoard</title>

    <script type="text/javascript" src="https://rally1.rallydev.com/apps/2.1/sdk.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("wsjfProgressBar",{alias:"widget.wsjfProgressBar",extend:Ext.Component,constructor:function(e){this.callParent(arguments),this.renderTpl=Ext.create("Rally.ui.renderer.template.progressbar.ProgressBarTemplate",{percentDoneName:"PercentDone",height:"15px",width:"100%%",isClickable:!1,calculateColorFn:function(e){return Rally.util.Colors.cyan}}),this.on({afterrender:this._onAfterRender,scope:this})},_onAfterRender:function(){this.update()},value:0,set:function(e){this.value=e,this.update()},update:function(e){void 0!==e&&(this.value=e);var t=this.renderTpl.apply({PercentDone:this.value});this.callParent([t])}}),Ext.define("Rally.ui.grid.plugin.DependenciesPopoverPlugin",{extend:"Ext.AbstractPlugin",alias:"plugin.rallydependenciesplugin",require:["Rally.ui.popover.DependenciesPopover"],init:function(e){this.callParent(arguments),this._delayedTask=Ext.create("Ext.util.DelayedTask",this._showPopover,this),this.cmp.on("afterrender",function(){this.cmp.getEl().on("mouseover",this._onMouseOver,this,{delegate:".formatted-id-link"}),this.cmp.getEl().on("mouseout",this._onMouseOut,this,{delegate:".formatted-id-link"})},this,{single:!0})},_onMouseOver:function(e,t){this._delayedTask.delay(500,null,null,[t])},_onMouseOut:function(){this._delayedTask.cancel()},_showPopover:function(e){var t=Ext.get(e),i=t.up(this.cmp.view.getDataRowSelector()),a=this.cmp.view.getRecord(i);if(a&&!Ext.getElementById("description-popover")){var l=t.dom.href&&_.last(t.dom.href.split("/detail/")),o=l&&Rally.util.Ref.getOidFromRef(l),n={context:this.cmp.context,field:"Description",target:t,targetSelector:"#"+t.id};o&&a.get("ObjectID")!==o?(n.oid=o,n.type=Rally.util.Ref.getTypeFromRef(l)):n.record=a,Rally.ui.popover.PopoverFactory.bake(n)}},destroy:function(){this._delayedTask&&this._delayedTask.cancel()}}),Ext.define("Rally.ui.bulk.RecordMenuFix",{override:"Rally.ui.menu.bulk.RecordMenu",_getMenuItems:function(){var e=this.getRecords(),t=this.callParent(arguments);return t.push({xtype:"wsjfBulkSetRisk",id:"wsjfBulkSetRisk"}),t.push({xtype:"wsjfBulkSetCost",id:"wsjfBulkSetValue"}),t.push({xtype:"wsjfBulkSetCust",id:"wsjfBulkSetTime"}),t.push({xtype:"wsjfBulkSetRevn",id:"wsjfBulkSetRevn"}),!1===Ext.getCmp("wsjfApp").getSetting("usePrelim")&&t.push({xtype:"wsjfBulkSetSize",id:"wsjfBulkSetSize"}),_.each(t,function(t){Ext.apply(t,{records:e,store:this.store,onBeforeAction:this.onBeforeAction,onActionComplete:this.onActionComplete,context:this.getContext()})},this),t}}),Ext.define("CustomApp",{extend:"Rally.app.TimeboxScopedApp",componentCls:"app",settingsScope:"project",id:"wsjfApp",config:{defaultSettings:{usePrelim:!1,showFilter:!1,useWSJFReadOnly:!0,useStateField:!1,useProjectField:!1,useWSJFAutoSort:!0,showChange:!0,globalOverride:!0}},_customFields:["c_controlWSJF","c_CostImpactWeighting","c_CustomerImpactWeighting","c_RiskImpactWeighting","c_RevenueImpactWeighting"],stateful:!0,onTimeboxScopeChange:function(e){this.callParent(arguments),this._startApp(this)},getSettingsFields:function(){return[{xtype:"textarea",fieldLabel:"Query",name:"query",anchor:"100%",cls:"query-field",margin:"0 70 0 0",plugins:[{ptype:"rallyhelpfield",helpId:194},"rallyfieldvalidationui"],validateOnBlur:!1,validateOnChange:!1,validator:function(e){try{return e&&Rally.data.wsapi.Filter.fromQueryString(e),!0}catch(e){return e.message}}},{xtype:"rallycheckboxfield",fieldLabel:"Use Preliminary Estimate",labelWidth:200,name:"usePrelim"},{xtype:"rallycheckboxfield",fieldLabel:"Make WSJF field read-only",labelWidth:200,name:"useWSJFReadOnly"},{xtype:"rallycheckboxfield",fieldLabel:"Auto-sort on change",labelWidth:200,name:"useWSJFAutoSort"},{xtype:"rallycheckboxfield",fieldLabel:"Show State Field",labelWidth:200,name:"useStateField"},{xtype:"rallycheckboxfield",fieldLabel:"Show Project Field",labelWidth:200,name:"useProjectField"},{xtype:"rallycheckboxfield",fieldLabel:"Show Advanced filter on the application. This will remove the ability to commit the rank",labelWidth:200,name:"showFilter"},{xtype:"rallycheckboxfield",fieldLabel:"Allow Weighting Changes",labelWidth:200,name:"showChange"},{xtype:"rallycheckboxfield",fieldLabel:"Allow Global Rank Override",labelWidth:200,name:"globalOverride"}]},launch:function(){Deft.Chain.pipeline([this._adminStatus,this._getProject,this._setupApp,this._getStateValues,this._startApp],this)},_getStateValues:function(e){var t=this,i=Ext.create("Deft.Deferred");return Rally.data.ModelFactory.getModel({type:e}).then({success:function(e){t.stateValues=e.getField("State").getAllowedStringValues(),i.resolve(t)},failure:function(){i.reject()}}),i.promise},_adminStatus:function(){var e=this;e.weAreAdmin=!1;var t=Ext.create("Deft.Deferred"),i=e.getContext().getGlobalContext().context.scope.projectOid;return Ext.create("Rally.data.wsapi.Store",{model:"Project",autoLoad:!0,fetch:["Children","Name"].concat(this._customFields),filters:[{property:"ObjectID",value:i}],limit:"Infinity",listeners:{load:function(i,a){a[0].get("c_controlWSJF")&&(e.weAreAdmin=!0),t.resolve(a)}}}),t.promise},_getProject:function(e){var t=this.getContext().getProject(),i=Ext.create("Deft.Deferred");return Ext.create("Rally.data.wsapi.Store",{model:"Project",autoLoad:!0,fetch:["Children","Name"].concat(this._customFields),filters:[{property:"ObjectID",value:t.ObjectID}],limit:"Infinity",listeners:{load:function(e,t){i.resolve(t)}}}),i.promise},_setupApp:function(e){var t=Ext.create("Deft.Deferred"),i=e[0],a=this;this.add({xtype:"container",id:"headerBox",layout:"column",border:3,style:{borderColor:Rally.util.Colors.cyan,borderStyle:"solid"}}),this.add({xtype:"container",id:"filterBox"}),Ext.getCmp("headerBox").add({xtype:"rallyportfolioitemtypecombobox",labelWidth:150,fieldLabel:"Choose portfolio type:",id:"itemType",margin:10,listeners:{ready:function(){t.resolve("portfolioitem/"+this.rawValue),this.on("select",function(){a._startApp(a)})}},scope:this,align:"left"}),a.getSetting("showFilter")&&Ext.getCmp("headerBox").add({xtype:"rallyinlinefiltercontrol",name:"inlineFilter",itemId:"inlineFilter",margin:"10 10 10 10",context:this.getContext(),height:26,inlineFilterButtonConfig:{stateful:!0,stateId:this.getContext().getScopedStateId("inline-filter"),context:this.getContext(),modelNames:["PortfolioItem"],filterChildren:!1,inlineFilterPanelConfig:{quickFilterPanelConfig:{defaultFields:["ArtifactSearch","Owner"]}},listeners:{inlinefilterchange:this._onFilterChange,inlinefilterready:this._onFilterReady,scope:this}}});Ext.getCmp("headerBox").add({xtype:"container",listeners:{afterrender:function(){}},layout:"hbox",items:[{xtype:"container",items:[{xtype:"container",layout:"hbox",items:[{xtype:"label",width:"120px",margin:"10 0 10 10",text:"Cost Weighting",forId:"costweighting"},{xtype:"wsjfProgressBar",width:"100px",margin:"10 10 0 10",id:"costweighting",value:i.get("c_CostImpactWeighting")/100}]},{xtype:"container",layout:"hbox",items:[{xtype:"label",width:"120px",margin:"0 0 10 10",text:"Customer Weighting",forId:"custweighting"},{xtype:"wsjfProgressBar",width:"100px",margin:"0 10 10 10",value:i.get("c_CustomerImpactWeighting")/100,id:"custweighting"}]}]},{xtype:"container",items:[{xtype:"container",layout:"hbox",items:[{xtype:"label",width:"120px",margin:"10 0 0 10",text:"Revenue Weighting",forId:"revnweighting"},{xtype:"wsjfProgressBar",width:"100px",margin:"10 10 0 10",id:"revnweighting",value:i.get("c_RevenueImpactWeighting")/100}]},{xtype:"container",layout:"hbox",items:[{xtype:"label",width:"120px",margin:"10 0 10 10",text:"Risk Weighting",forId:"riskweighting"},{xtype:"wsjfProgressBar",width:"100px",margin:"10 10 0 10",id:"riskweighting",value:i.get("c_RiskImpactWeighting")/100}]}]}]});if(a.weAreAdmin){var l=Ext.create("Ext.Container",{id:"weightingBox",layout:"hbox",items:[{xtype:"container",id:"innerbox",layout:"vbox",items:[{xtype:"rallybutton",margin:"10 0 0 10",width:160,text:"Change Weightings",style:{backgroundColor:Rally.util.Colors.cyan},handler:function(){var e=Ext.create("Rally.ui.dialog.Dialog",{id:"projectChooser",items:[{xtype:"rallyprojectpicker",id:"projectChooserId",listeners:{expand:function(e){this.setValueForProjectRef(i.get("_ref"))}}},{xtype:"rallycheckboxfield",fieldLabel:"Change all children projects",id:"doChildrenId",disabled:!0},{xtype:"container",id:"sliderId",layout:"hbox",items:[{xtype:"rallyslider",id:"costSlider",minValue:0,maxValue:100,vertical:!0,height:300,labelAlign:"top",value:100*(Ext.getCmp("costweighting").value||1),fieldLabel:"Cost",margin:"0 0 0 10"},{xtype:"rallyslider",id:"custSlider",minValue:0,maxValue:100,vertical:!0,height:300,value:100*(Ext.getCmp("custweighting").value||1),labelAlign:"top",fieldLabel:"Customer"},{xtype:"rallyslider",vertical:!0,minValue:0,maxValue:100,height:300,id:"revnSlider",value:100*(Ext.getCmp("revnweighting").value||1),labelAlign:"top",fieldLabel:"Revenue"},{xtype:"rallyslider",vertical:!0,height:300,minValue:0,maxValue:100,id:"riskSlider",value:100*(Ext.getCmp("riskweighting").value||1),labelAlign:"top",fieldLabel:"Risk"}]}],autoShow:!0,closable:!0,width:400,title:"Choose Projects to Change",listeners:{afterrender:function(){Ext.getCmp("projectChooserId").on("expand",this._enableOK)}},buttons:[{text:"OK",disabled:!0,id:"OKbutton",handler:function(t,i,l){a._changeProjectWeightings(Ext.getCmp("projectChooserId"),Ext.getCmp("doChildrenId"),Ext.getCmp("sliderId"));var o=Ext.getCmp("piGrid").store,n=Ext.getCmp("wsjfApp");_.each(o.getRecords(),function(e){var t=n._calcWSJF(e).toFixed(2);t!==e.get("c_weightedWSJF").toFixed(2)&&e.set("c_weightedWSJF",parseFloat(t))}),e.destroy()}},{text:"Cancel",handler:function(){e.destroy()}}],scope:a,_enableOK:function(){Ext.getCmp("OKbutton").enable()}})}},{xtype:"rallybutton",id:"saveWeightings",margin:"9 0 10 10",width:160,text:"Save Weighted WSJF",style:{backgroundColor:Rally.util.Colors.cyan},handler:this._saveStore,scope:this}]}]});l.add({xtype:"rallybutton",id:"commitWWSJF",margin:10,width:160,text:"Commit Weighted WSJF",style:{backgroundColor:Rally.util.Colors.cyan},handler:this._commitWWSJF,scope:this}),this.getContext().getTimeboxScope()||a.getSetting("showFilter")||(l.add({xtype:"rallybutton",id:"MakeItSo",margin:10,width:160,text:"Rank by WSJF",style:{backgroundColor:Rally.util.Colors.cyan},handler:this.commitRecords,scope:this}),a.getSetting("globalOverride")&&l.add({xtype:"rallycheckboxfield",fieldLabel:"Override global rank",id:"globalCheck",value:!1})),Ext.getCmp("headerBox").add(l)}return t.promise},_changeProjectWeightings:function(e,t,i){var a=e.getSelectedRecord(),l=i.getComponent("riskSlider").getSubmitValue();a.set("c_RiskImpactWeighting",l);var o=i.getComponent("custSlider").getSubmitValue();a.set("c_CustomerImpactWeighting",o);var n=i.getComponent("costSlider").getSubmitValue();a.set("c_CostImpactWeighting",n);var r=i.getComponent("revnSlider").getSubmitValue();a.set("c_RevenueImpactWeighting",r),a.save({callback:function(){console.log("Project Weightings: ",l,n,o,r),Ext.getCmp("riskweighting").update(l/100),Ext.getCmp("costweighting").update(n/100),Ext.getCmp("custweighting").update(o/100),Ext.getCmp("revnweighting").update(r/100)}})},_onFilterChange:function(e){this.advFilters=e.getTypesAndFilters().filters,this._startApp(this)},_onFilterReady:function(e){Ext.getCmp("filterBox").add(e)},_getFilters:function(e){var t=[];if(Ext.getCmp("itemType").getRecord()&&0===Ext.getCmp("itemType").getRecord().data.Ordinal){var i=this.getContext().getTimeboxScope();if(i){var a=i.getQueryFilter();a.value?t.push(a.value.config):t.push({property:"Release",operator:"=",value:null})}}t.push({property:"State.Name",operator:"!=",value:e.stateValues[e.stateValues.length-1]});var l=e.getSetting("query");if(l){var o=Ext.getCmp("MakeItSo");o&&o.hide();var n=Ext.getCmp("globalCheck");n&&n.hide();var r=Rally.data.wsapi.Filter.fromQueryString(l);r.itemId=r.toString(),t.push(r)}return this.getSetting("showFilter")&&this.advFilters.length>0&&Ext.Array.each(this.advFilters,function(e){t.push(e)}),t},_startApp:function(e){var t=["portfolioitem/"+Ext.getCmp("itemType").rawValue],i=Ext.getCmp("piGrid");i&&i.destroy();var a=["FormattedID",{dataIndex:"Name"}];e.getSetting("useStateField")&&a.push({dataIndex:"State",text:"State",align:"center"}),e.getSetting("useProjectField")&&a.push({dataIndex:"Project",text:"Project",align:"center"}),a.push({dataIndex:"c_CostImpactRating",text:"Cost Impact",align:"center",listeners:{afterrender:function(){thisMenu=Ext.create("wsjfBulkSetCost"),helpHTML=thisMenu.getHelp(),Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:helpHTML})}},editor:null},{dataIndex:"c_RevenueImpactRating",text:"Revenue Impact",align:"center",listeners:{afterrender:function(){thisMenu=Ext.create("wsjfBulkSetRevn"),helpHTML=thisMenu.getHelp(),Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:helpHTML})}},editor:null},{dataIndex:"c_CustomerImpactRating",text:"Customer Impact",align:"center",listeners:{afterrender:function(){thisMenu=Ext.create("wsjfBulkSetCust"),helpHTML=thisMenu.getHelp(),Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:helpHTML})}},editor:null},{dataIndex:"c_RiskImpactRating",text:"Risk Impact",align:"center",listeners:{afterrender:function(){thisMenu=Ext.create("wsjfBulkSetRisk"),helpHTML=thisMenu.getHelp(),Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:helpHTML})}},editor:null}),sizeCol={text:"Size",align:"center",listeners:{afterrender:function(){thisMenu=Ext.create("wsjfBulkSetSize"),helpHTML=thisMenu.getHelp(),Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:helpHTML})}}},e.getSetting("usePrelim")?sizeCol=_.merge(sizeCol,{dataIndex:"PreliminaryEstimate"}):sizeCol=_.merge(sizeCol,{dataIndex:"JobSize"}),a.push(sizeCol);var l=new Ext.XTemplate("<div {[this.cellCheck(values)]}>{[this.cellFormat(values.c_weightedWSJF)]}</div>",{cellCheck:function(e){return e.c_weightedWSJF.toFixed(2)>e.WSJFScore?'class="upgradedItem"':e.c_weightedWSJF.toFixed(2)<e.WSJFScore?'class="downgradedItem"':""},cellFormat:function(e){return e.toFixed(2)}});weightedWsjfCol={dataIndex:"c_weightedWSJF",text:"Weighted WSJF",xtype:"templatecolumn",tpl:l,align:"center",editRenderer:function(){},editor:null},a.push(weightedWsjfCol),wsjfCol={dataIndex:"WSJFScore",text:"Current WSJF",align:"center",listeners:{afterrender:function(){Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:"<p><strong>WSJF = Impact(Risk + Cost + Revenue + Customer)/Job Size</strong></p>"})}}},e.getSetting("useWSJFReadOnly")&&(wsjfCol=_.merge(wsjfCol,{editor:null})),a.push(wsjfCol);var o=Ext.create("Rally.ui.grid.Grid",{id:"piGrid",margin:"40, 10, 40, 10",plugins:["rallydependenciesplugin"],columnCfgs:a,bulkEditConfig:{showEdit:!1,showTag:!1,showParent:!1,showRemove:!1},context:this.getContext(),enableBulkEdit:!0,enableRanking:!0,enableColumnResize:!0,sortableColumns:!0,storeConfig:{pageSize:200,batchAction:!0,model:t,sorters:[{property:"c_weightedWSJF",direction:"DESC"},{property:"DragAndDropRank",direction:"ASC"}],fetch:["FormattedID","PreliminaryEstimate","PreliminaryEstimateValue","State","Name","Release","Project","JobSize","c_controlWSJF","c_RevenueImpactRating","c_CostImpactRating","c_RiskImpactRating","c_CustomerImpactRating","WSJFScore","State"],filters:e._getFilters(e)},listeners:{inlineeditsaved:function(t,i,a){e._saveWSJF(i)},load:function(t){e._store=t},scope:e}});this.add(o)},_saveStore:function(){Ext.getCmp("wsjfApp")._store.getModifiedRecords().length>0&&(Ext.getCmp("weightingBox").setLoading("Saving values..."),Ext.getCmp("wsjfApp")._store.sync({callback:function(e,t){Ext.getCmp("weightingBox").setLoading(!1),console.log("Store save returned: ",e,t)}}))},_saveWSJF:function(e){if(e.raw.hasOwnProperty("c_weightedWSJF")){var t=this._calcWSJF(e).toFixed(2),i=(e.get("WSJFScore")||0).toFixed(2);t!==i&&(e.set("WSJFScore",parseFloat(t)),e.save({callback:function(){console.log("Updated WSJF for ",e.get("FormattedID")," from: ",oldval," to: ",t)}}))}},_commitWWSJF:function(){var e=Ext.getCmp("wsjfApp"),t=e._store.getRecords();_.each(t,function(e){e.get("WSJFScore")!==e.get("c_weightedWSJF")&&e.set("WSJFScore",e.get("c_weightedWSJF"))}),e._saveStore()},_calcWSJF:function(e){var t=0,i=0;return t=Math.abs(parseInt(e.get("c_RevenueImpactRating")||0)*Ext.getCmp("revnweighting").value)+Math.abs(parseFloat(e.get("c_CostImpactRating")||0))*Ext.getCmp("costweighting").value+Math.abs(parseFloat(e.get("c_CustomerImpactRating")||0))*Ext.getCmp("custweighting").value+Math.abs(parseFloat(e.get("c_RiskImpactRating")||0))*Ext.getCmp("riskweighting").value,Ext.getCmp("wsjfApp").getSetting("usePrelim")?(i=e.get("PreliminaryEstimateValue"))>0?t/=i:t=0:t/=e.get("JobSize"),t},_recordToRank:0,_rankingRecord:null,_store:null,commitRecords:function(){var e=this._store.getRecords();_.each(e,function(e){e.set("WSJFScore",parseFloat(e.get("c_weightedWSJF").toFixed(2)))}),this._store.sync(),this._recordToRank=0,this._rankingRecord=this._store.data.items[this._recordToRank],Ext.getCmp("globalCheck")&&!0===Ext.getCmp("globalCheck").value?this._rankingRecord.save({rankTo:"TOP",callback:function(e,t,i){this._recordToRank+=1,this._saveNextRecord()},scope:this}):(this._recordToRank+=1,this._saveNextRecord())},_saveNextRecord:function(){if(this._recordToRank<this._store.totalCount){var e=this._store.data.items[this._recordToRank];Rally.data.Ranker.rankRelative({recordToRank:e,relativeRecord:this._rankingRecord,position:"after",saveOptions:{callback:function(e,t,i){this._recordToRank+=1,this._rankingRecord=e,this._saveNextRecord()},scope:this}})}}}),Ext.define("dataModel",{extend:"Ext.data.Model",fields:[{name:"Name",type:"string"},{name:"Value",type:"integer"},{name:"Description",type:"string"}]}),Ext.define("Rally.ui.grid.localWSJFBulkSet",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.localWSJFBulkSet",_makeHelpFromData:function(){return html="",_.each(this.config.data,function(e){html+="<p><strong>"+e.Name+" "+e.Description+"</strong></p>"}),html},_onSetParam:function(e,t){var i=Ext.create("Ext.data.Store",{autoLoad:!0,model:"dataModel",data:this.config.data,proxy:{type:"memory",reader:{type:"json",root:"dataValues"}}}),a=Ext.create("Ext.form.ComboBox",{id:"localBox",store:i,queryMode:"local",displayField:"Name",valueField:"Value"}),l=Ext.create("Ext.form.field.Checkbox",{boxLabel:"Negative",margin:"0 0 0 20",checked:!1,id:"negativeCheck"});Ext.create("Rally.ui.dialog.Dialog",{id:"localChooser",autoShow:!0,draggable:!0,width:300,records:this.records,title:e,layout:"hbox",items:[a,l],buttons:[{text:"OK",handler:function(e,i,a){_.each(this.records,function(e){var i=1;Ext.getCmp("negativeCheck").value&&(i=-1),e.set(t,Ext.getCmp("localBox").value*i);var a=Ext.getCmp("wsjfApp")._calcWSJF(e);e.set("c_weightedWSJF",parseFloat(a.toFixed(2))),e.save({callback:function(){Ext.getCmp("wsjfApp").getSetting("useWSJFAutoSort")&&Ext.getCmp("piGrid").getView().refresh()}})}),Ext.getCmp("localChooser").destroy()},scope:this},{text:"Cancel",handler:function(){Ext.getCmp("localChooser").destroy()}}]})},getHelp:function(){return this._makeHelpFromData()}}),Ext.define("wsjfBulkSetRevn",{extend:Rally.ui.grid.localWSJFBulkSet,alias:"widget.wsjfBulkSetRevn",config:{text:"Revenue Impact Rating",handler:function(e,t,i){this._onSetParam("Choose Revenue Impact Rating","c_RevenueImpactRating")},data:[{Name:"None",Value:0,Description:"(0)"},{Name:"Minimal",Value:1,Description:"(1)"},{Name:"Low",Value:2,Description:"(2)"},{Name:"Medium",Value:3,Description:"(3)"},{Name:"High",Value:5,Description:"(5)"},{Name:"Very High",Value:8,Description:"(8)"},{Name:"Extreme",Value:13,Description:"(13)"}]}}),Ext.define("wsjfBulkSetRisk",{extend:Rally.ui.grid.localWSJFBulkSet,alias:"widget.wsjfBulkSetRisk",config:{text:"Risk Impact Rating",handler:function(e,t,i){this._onSetParam("Choose Risk Impact Rating","c_RiskImpactRating")},data:[{Name:"None",Value:0,Description:"(0)"},{Name:"Minimal",Value:1,Description:"(1)"},{Name:"Low",Value:2,Description:"(2)"},{Name:"Medium",Value:3,Description:"(3)"},{Name:"High",Value:5,Description:"(5)"},{Name:"Very High",Value:8,Description:"(8)"},{Name:"Extreme",Value:13,Description:"(13)"}]}}),Ext.define("wsjfBulkSetCust",{extend:Rally.ui.grid.localWSJFBulkSet,alias:"widget.wsjfBulkSetCust",config:{text:"Customer Impact Rating",handler:function(e,t,i){this._onSetParam("Choose Customer Impact Rating","c_CustomerImpactRating")},data:[{Name:"None",Value:0,Description:"(0)"},{Name:"Minimal",Value:1,Description:"(1)"},{Name:"Low",Value:2,Description:"(2)"},{Name:"Medium",Value:3,Description:"(3)"},{Name:"High",Value:5,Description:"(5)"},{Name:"Very High",Value:8,Description:"(8)"},{Name:"Extreme",Value:13,Description:"(13)"}]}}),Ext.define("wsjfBulkSetCost",{extend:Rally.ui.grid.localWSJFBulkSet,alias:"widget.wsjfBulkSetCost",config:{text:"Cost Impact Rating",handler:function(e,t,i){this._onSetParam("Choose Cost Impact Rating","c_CostImpactRating")},data:[{Name:"None",Value:0,Description:"(0)"},{Name:"Minimal",Value:1,Description:"(1)"},{Name:"Low",Value:2,Description:"(2)"},{Name:"Medium",Value:3,Description:"(3)"},{Name:"High",Value:5,Description:"(5)"},{Name:"Very High",Value:8,Description:"(8)"},{Name:"Extreme",Value:13,Description:"(13)"}]}}),Ext.define("wsjfBulkSetSize",{extend:Rally.ui.grid.localWSJFBulkSet,alias:"widget.wsjfBulkSetSize",config:{text:"Size",handler:function(e,t,i){this._onSetParam("Choose Size/Effort Rating","JobSize")},data:[{Name:"XS",Value:1,Description:"Less than 1 week"},{Name:"S",Value:2,Description:"1 - 3 weeks"},{Name:"M",Value:3,Description:"1 - 2 months"},{Name:"L",Value:5,Description:"3 - 6 months"},{Name:"XL",Value:8,Description:"6 - 9 months"},{Name:"XXL",Value:13,Description:"9 - 18 months"},{Name:"XXXL",Value:21,Description:"Two years or more"}]}});
                !function(){var t=window.Ext4||window.Ext;t.define("Rally.data.wsapi.collection.Proxy",{extend:"Rally.data.wsapi.Proxy",requires:["Rally.data.wsapi.ProxyBase"],alias:["proxy.Rally.data.WsapiCollectionProxy","proxy.rallywsapicollectionproxy"],alternateClassName:["Rally.data.WsapiCollectionProxy"],mixins:{proxy:"Rally.data.wsapi.ProxyBase"},urlMappings:{create:"add",destroy:"remove"},statics:{MAX_ARTIFACTS_PER_OPERATION:25},constructor:function(){this.callParent(arguments)},buildRequest:function(t){var a=this.callParent(arguments);return a.requester=this.requester,a},buildUrl:function(t){return t.url=this.url,this.urlMappings[t.action]&&(t.url+="/"+this.urlMappings[t.action]),t.url},getMethod:function(t){return"read"===t.action?"GET":"POST"},batch:function(a,r){var e,i,n,o,s,l,c=this,p=c.batchActions;void 0===a.operations&&(a={operations:a,listeners:r}),a.batch?t.isDefined(a.batch.runOperation)&&(e=t.applyIf(a.batch,{proxy:c,listeners:{}})):a.batch={proxy:c,listeners:a.listeners||{}},e||(e=new t.data.Batch(a.batch)),e.on("complete",t.bind(c.onBatchComplete,c,[a],0)),o=(n=c.batchOrder.split(",")).length;var u=function(a){e.add(new t.data.Operation({action:s,records:[a]}))},d=function(a){p?e.add(new t.data.Operation({action:s,records:a})):_.each(a,u)};for(l=0;l<o;l++){s=n[l],i=a.operations[s];var h=this._splitBatch(i);_.each(h,d,h)}return e.start(),e},_splitBatch:function(t){return _.chain(t).groupBy(function(t,a){return Math.floor(a/this.self.MAX_ARTIFACTS_PER_OPERATION)},this).toArray().value()}})}();

            Rally.launchApp('CustomApp', {
                name:"WSJFBoard",
                parentRepos:"",
                version:"0.1.1"
            });

        });
    </script>


    <style type="text/css">
        .upgradedItem{border-style:solid;border-width:0px 5px 0px 0px;border-color:#ff4040}.downgradedItem{border-style:solid;border-width:0px 5px 0px 0px;border-color:#4040ff}
    </style>
</head>
<body>
</body>
</html>
